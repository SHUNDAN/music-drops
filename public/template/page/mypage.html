

<!-- Mypage -->
<script id="page_mypage" type="text/template">


<!--
    <h1>Mypage</h1>
<br>
<br>
<br>
<br>
<br>
-->


<h2 class="kari_h2">すべてのPocket</h2>
<div class="kari_pocketConditionArea">
    <input type="text" class="conditionInput" value="" placeholder="曲名やアーティスト名を入力してください"></input>
    <input type="button" class="refineButton" value="絞り込む"/>
</div>
<section class="kari_mypageArea1">
    <div id="playlistArea" class="kari_playlistArea">
        <div class="titleArea">
            <div class="playlostHead">プレイリスト</div>
            <input type="button" class="editButton" value="Edit"/>
        </div>
        <ul class="playlist">
            <li><a href="#" onclick="return false;">思い出の曲</a></li>
            <li><a href="#" onclick="return false;">癒しを受ける曲</a></li>
            <li><a href="#" onclick="return false;">全ての曲</a></li>
        </ul>
    </div>
    <div id="pocketListArea" class="kari_pocketListArea"></div>
</section>



<br>
<br>
<br>
<br>
<br>


    <h2>UserInfo</h2>
    <table class="table">
        <tr>
            <td>User Id</td>
            <td><%- user_id %></td>
        </tr>
        <tr>
            <td>User Name</td>
            <td><%- name %></td>
        </tr>
    </table>

    <h2 class="mt20">PocketList</h2>

    <div class="mb10">
        <input id="titleCondition" type="text" style="width:300px" data-event="filterPockets" placeholder="title絞り込み"/>
        <input id="artistCondition" type="text" style="width:300px" data-event="filterPockets" placeholder="artist絞り込み"/>
        <input id="tagsCondition" type="text" style="width:300px" data-event="filterPockets" placeholder="tag絞り込み"/>
        <button class="btn btn-primary mr5" data-event="saveFilter">このFilterを保存する</button>
        <button class="btn btn-success mr5" data-event="clearFilter">Filterを解除する</button>
        <button class="btn btn-danger mr5" data-event="deleteFilter">選択中のFilterを削除する</button>
    </div>
    <div id="savedFilter" class="mb10 floatLeft clearFix"></div>
    <table class="table">
        <tr>
            <th>Music</th>
            <th>Sample</th>
            <th>Youtube</th>
            <th>Create</th>
            <th></th>
        </tr>
        <tr>
            <tbody id="poplist"></tbody>
        </tr>
    </table>

    <h2 class="mt20">フォロー関係</h2>
    <div id="followUserList"></div>
    <div id="followedUserList"></div>


    <h2 class="mt20">お知らせ一覧</h2>
    <table class="table">
        <tr>
            <th>Message</th>
            <th>#</th>
        </tr>
        <tr>
            <tbody id="notification_list"></tbody>
        </tr>
    </table>



</script>







<!--並び替えとかやるためのPocketList一覧-->
<script id="page_mypage_user_pocket_list" type="text/template">
    <div class="totalNum">全 <%=pocketList.length%>曲</div>
    <%_.each(pocketList, function (pocket) {%>
        <div class="kari_pocketListItem" data-pocket-id="<%=pocket.attributes.id%>">
            <img src="<%=pocket.attributes.artwork_url%>" alt="" class="artwork"/>
            <div class="info">
                <a href="#music/<%=pocket.attributes.music_id%>" class="songName"><%=pocket.attributes.title%></a><br>
                <a href="#artist/<%=pocket.attributes.artist_id%>" class="artistName"><%=pocket.attributes.artist_name%></a>
            </div>
            <%if (pocket.attributes.youtube_id) {%>
                <div class="playBtn redBtn" data-event-click="playMusic">▶</div>
            <%} else {%>
                <div class="playBtn blueBtn" data-event-click="playMusic">▶</div>
            <%}%>
            <div class="delBtn" data-event-click="deletePocket">DEL</div>
        </div>
    <%});%>
</script>











<!-- Saved Filter -->
<script id="page_mypage_saved_filter" type="text/template">
    <%_.each(pocket_filter_object, function (condition) {%>
        <div class="btn mr5" data-event="useFilter" data-title="<%=condition.title%>" data-artist="<%=condition.artist%>" data-tags='<%=JSON.stringify(condition.tags)%>'>
            <%=condition.title%>, <%=condition.artist%>, <%=JSON.stringify(condition.tags)%>
        </div>
    <%});%>
</script>













<!-- Mypage: User Pocket List -->
<script id="page_mypage_poplist" type="text/template">
    <% 
        var idx = 0;
        _.each(pocketList, function (pocket) { 
    %>
        <tr data-pocket-id="<%-pocket.attributes.id%>">
            <% 
                var feelingId = pocket.attributes.feeling_id;
                var feelingName = ' - ';
                _.each(feelings, function (feeling) {
                    if (feeling.id === feelingId) {
                        feelingName = feeling.name;
                    }
                });
            %>
            <td class="wb">
                <a href="#music/<%-pocket.attributes.music_id%>"><%=pocket.attributes.title%></a>
                /
                <a href="#artist/<%-pocket.attributes.artist_id%>"><%=pocket.attributes.artist_name%></a>
            </td>
            <td><audio style="max-width:200px;" src="<%-pocket.attributes.song_url%>" controls preload="none"></audio></td>
            <% if (pocket.attributes.youtube_id) { %>
                <td><div class="btn btn-primary" data-youtube-id="<%-pocket.attributes.youbute_id%>" data-event="showYoutube" data-pos=<%=idx++%>>▶</div></td>
            <% } else { %>
                <td  class="text-center"> - </td>
            <% } %>
            <td class="wb"><%- _.formatTimestamp(pocket.attributes.create_at) %></td>
            <td><div class="btn btn-danger" data-pocket-id="<%-pocket.attributes.id%>" data-event="deletePocket">D</div></td>
        </tr>
    <% }); %>
</script>


<!-- Mypage: お知らせ一覧 -->
<script id="page_mypage_notification_list" type="text/template">
    <% if (notificationList.length === 0 ) %>
        <tr>
            <td>なし</td>
        </tr>
    <% } else { %>
        <% _.each(notificationList, function (notif) { %>
            <tr>
                <td>
                    <%if (notif.attributes.type === 1) { %>
                        <a href="#user/<%-notif.attributes.json.user.id%>"><%=notif.attributes.json.user.name%></a>さんが、
                        <a href="#music/<%-notif.attributes.json.music.id%>"><%=notif.attributes.json.music.title%></a>をPocketしました。
                    <% } %>
                </td>
                <td>
                    <div class="btn btn-danger" data-notification-id="<%-notif.attributes.id%>" data-event="deleteNotification">D</div>
                </td>
            </tr>
        <% }); %>
    <% } %>
</script>



































